## Curriculum Learning
### ğŸ“– ä»€ä¹ˆæ˜¯ Curriculum Learningï¼Ÿ

**Curriculum Learningï¼ˆè¯¾ç¨‹å­¦ä¹ ï¼‰** æ˜¯ä¸€ç§æœºå™¨å­¦ä¹ è®­ç»ƒç­–ç•¥ï¼Œçµæ„Ÿæ¥æºäºäººç±»å­¦ä¹ çš„è¯¾ç¨‹å®‰æ’ã€‚å®ƒé€šè¿‡**æŒ‰ç…§ä»æ˜“åˆ°éš¾çš„é¡ºåº**ç»„ç»‡è®­ç»ƒæ•°æ®ï¼Œé€æ­¥å¢åŠ ä»»åŠ¡çš„å¤æ‚æ€§ï¼Œä»è€Œæé«˜æ¨¡å‹çš„è®­ç»ƒæ•ˆç‡å’Œæ€§èƒ½ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯è®©æ¨¡å‹å…ˆå­¦ä¹ ç®€å•çš„æ ·æœ¬æˆ–ä»»åŠ¡ï¼Œå†é€æ¸è¿‡æ¸¡åˆ°å¤æ‚çš„æ ·æœ¬æˆ–ä»»åŠ¡ï¼Œä»¥é¿å…æ¨¡å‹åœ¨ä¸€å¼€å§‹å°±è¢«å›°éš¾æ ·æœ¬â€œæ·¹æ²¡â€ã€‚

#### æ ¸å¿ƒç‰¹ç‚¹ï¼š
1. **ä»æ˜“åˆ°éš¾**ï¼šè®­ç»ƒæ•°æ®æŒ‰éš¾åº¦åˆ†é˜¶æ®µæä¾›ï¼Œæ¨¡å‹å…ˆæŒæ¡ç®€å•æ¨¡å¼ï¼Œå†å­¦ä¹ å¤æ‚æ¨¡å¼ã€‚
2. **æé«˜æ”¶æ•›æ€§**ï¼šé€šè¿‡å¾ªåºæ¸è¿›çš„å­¦ä¹ ï¼Œæ¨¡å‹æ›´å®¹æ˜“æ‰¾åˆ°å…¨å±€æœ€ä¼˜è§£ï¼Œé¿å…é™·å…¥å±€éƒ¨æœ€ä¼˜ã€‚
3. **é€‚ç”¨åœºæ™¯**ï¼šå¸¸ç”¨äºæ·±åº¦å­¦ä¹ ä»»åŠ¡ï¼Œå¦‚å›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹ã€è‡ªç„¶è¯­è¨€å¤„ç†ç­‰ï¼Œå°¤å…¶åœ¨æ•°æ®åˆ†å¸ƒå¤æ‚æˆ–ä»»åŠ¡éš¾åº¦é«˜çš„æƒ…å†µä¸‹æ•ˆæœæ˜¾è‘—ã€‚

#### ä¼˜ç‚¹ï¼š
- åŠ é€Ÿæ”¶æ•›ï¼Œå‡å°‘è®­ç»ƒæ—¶é—´ã€‚
- æé«˜æ¨¡å‹æ³›åŒ–èƒ½åŠ›ï¼Œç‰¹åˆ«æ˜¯åœ¨å›°éš¾ä»»åŠ¡ä¸Šã€‚
- æ¨¡æ‹Ÿäººç±»å­¦ä¹ è¿‡ç¨‹ï¼Œç¬¦åˆç›´è§‰ã€‚

#### æŒ‘æˆ˜ï¼š
- éœ€è¦å®šä¹‰â€œéš¾åº¦â€çš„æ ‡å‡†ï¼ˆå¯èƒ½æ˜¯ä¸»è§‚çš„æˆ–ä¾èµ–äºä»»åŠ¡ï¼‰ã€‚
- å®ç°ä¸Šå¯èƒ½éœ€è¦é¢å¤–çš„æ•°æ®é¢„å¤„ç†æˆ–è°ƒåº¦é€»è¾‘ã€‚



### ğŸ“– Curriculum Learning çš„åŸç†

1. **å®šä¹‰éš¾åº¦**ï¼š
   - éš¾åº¦å¯ä»¥åŸºäºæ ·æœ¬çš„ç‰¹æ€§ï¼ˆä¾‹å¦‚å›¾åƒåˆ†è¾¨ç‡ã€å¥å­é•¿åº¦ã€ä»»åŠ¡å¤æ‚åº¦ï¼‰æˆ–æ¨¡å‹çš„é¢„æµ‹éš¾åº¦ï¼ˆå¦‚æŸå¤±å€¼ã€ç½®ä¿¡åº¦ï¼‰æ¥å®šä¹‰ã€‚
   - ä¾‹å¦‚ï¼Œåœ¨å›¾åƒåˆ†ç±»ä¸­ï¼Œä½åˆ†è¾¨ç‡æˆ–æ¸…æ™°çš„å›¾åƒå¯èƒ½è¢«è®¤ä¸ºæ˜¯â€œç®€å•â€æ ·æœ¬ï¼Œè€Œé«˜åˆ†è¾¨ç‡æˆ–æ¨¡ç³Šçš„å›¾åƒæ˜¯â€œå›°éš¾â€æ ·æœ¬ã€‚

2. **æ•°æ®æ’åºæˆ–åˆ†ç»„**ï¼š
   - å°†æ•°æ®é›†æŒ‰éš¾åº¦æ’åºï¼Œæˆ–è€…åˆ†æˆè‹¥å¹²éš¾åº¦çº§åˆ«ï¼ˆå¦‚ç®€å•ã€ä¸­ç­‰ã€å›°éš¾ï¼‰ã€‚
   - è®­ç»ƒæ—¶ï¼Œæ¨¡å‹å…ˆæ¥è§¦ä½éš¾åº¦æ•°æ®ï¼Œé€æ­¥å¼•å…¥é«˜éš¾åº¦æ•°æ®ã€‚

3. **è®­ç»ƒè°ƒåº¦**ï¼š
   - ä½¿ç”¨ä¸€ç§è°ƒåº¦ç­–ç•¥ï¼ˆå¦‚çº¿æ€§å¢åŠ ã€æŒ‡æ•°å¢åŠ ï¼‰æ¥æ§åˆ¶å¼•å…¥æ›´éš¾æ ·æœ¬çš„æ—¶æœºã€‚
   - å¯ä»¥åœ¨æ¯ä¸ª epoch æˆ– iteration è°ƒæ•´æ•°æ®åˆ†å¸ƒã€‚



### ğŸ“– ç®€å•ä»£ç ç¤ºä¾‹ï¼šåŸºäº PyTorch çš„ Curriculum Learning

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºå¦‚ä½•åœ¨ PyTorch ä¸­å®ç° Curriculum Learningã€‚æˆ‘ä»¬ä»¥ **MNIST æ•°æ®é›†** ä¸ºä¾‹ï¼Œå‡è®¾â€œéš¾åº¦â€æ˜¯åŸºäºå›¾åƒçš„åƒç´ å‡å€¼ï¼ˆåƒç´ å‡å€¼è¶Šä½ï¼Œå›¾åƒè¶Šæš—ï¼Œå¯èƒ½æ›´éš¾è¯†åˆ«ï¼‰ã€‚æ¨¡å‹å…ˆè®­ç»ƒç®€å•çš„ï¼ˆæ˜äº®ï¼‰æ ·æœ¬ï¼Œå†é€æ­¥å¼•å…¥è¾ƒéš¾çš„ï¼ˆè¾ƒæš—ï¼‰æ ·æœ¬ã€‚

```python
import torch
import torch.nn as nn
import torch.optim as optim
from torchvision import datasets, transforms
from torch.utils.data import DataLoader, Subset
import numpy as np

# 1. å®šä¹‰æ¨¡å‹
class SimpleNet(nn.Module):
    def __init__(self):
        super(SimpleNet, self).__init__()
        self.fc1 = nn.Linear(28 * 28, 256)
        self.fc2 = nn.Linear(256, 10)
    
    def forward(self, x):
        x = x.view(-1, 28 * 28)
        x = torch.relu(self.fc1(x))
        return self.fc2(x)

# 2. è®¡ç®—æ ·æœ¬éš¾åº¦ï¼ˆåŸºäºåƒç´ å‡å€¼ï¼Œå€¼è¶Šä½è¶Šæš—ï¼Œå‡è®¾è¶Šéš¾ï¼‰
def compute_difficulty(images):
    return images.view(images.size(0), -1).mean(dim=1).numpy()

# 3. æ•°æ®åŠ è½½ä¸éš¾åº¦æ’åº
transform = transforms.ToTensor()
train_dataset = datasets.MNIST('.', train=True, download=True, transform=transform)

# è®¡ç®—æ¯ä¸ªæ ·æœ¬çš„éš¾åº¦
images, _ = zip(*[(img, label) for img, label in train_dataset])
difficulties = compute_difficulty(torch.stack(images))

# æŒ‰éš¾åº¦æ’åºï¼ˆä»å°åˆ°å¤§ï¼Œç®€å•åˆ°å›°éš¾ï¼‰
indices = np.argsort(difficulties)
sorted_dataset = Subset(train_dataset, indices)

# 4. åˆ›å»ºåˆ†é˜¶æ®µçš„æ•°æ®åŠ è½½å™¨ï¼ˆç®€å•ã€ä¸­ç­‰ã€å›°éš¾ï¼‰
num_samples = len(sorted_dataset)
easy_subset = Subset(sorted_dataset, range(0, num_samples // 3))  # å‰ 1/3 ç®€å•
medium_subset = Subset(sorted_dataset, range(num_samples // 3, 2 * num_samples // 3))  # ä¸­é—´ 1/3
hard_subset = Subset(sorted_dataset, range(2 * num_samples // 3, num_samples))  # å 1/3

# æ•°æ®åŠ è½½å™¨
batch_size = 64
easy_loader = DataLoader(easy_subset, batch_size=batch_size, shuffle=True)
medium_loader = DataLoader(medium_subset, batch_size=batch_size, shuffle=True)
hard_loader = DataLoader(hard_subset, batch_size=batch_size, shuffle=True)

# 5. è®­ç»ƒè®¾ç½®
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
model = SimpleNet().to(device)
optimizer = optim.Adam(model.parameters(), lr=1e-3)
criterion = nn.CrossEntropyLoss()

# 6. Curriculum Learning è®­ç»ƒå¾ªç¯
def train_epoch(loader, model, optimizer, criterion, epoch):
    model.train()
    total_loss = 0
    for data, target in loader:
        data, target = data.to(device), target.to(device)
        optimizer.zero_grad()
        output = model(data)
        loss = criterion(output, target)
        loss.backward()
        optimizer.step()
        total_loss += loss.item()
    print(f"Epoch {epoch}, Avg Loss: {total_loss / len(loader):.6f}")

# 7. è¯¾ç¨‹è°ƒåº¦ï¼šå…ˆç®€å•ï¼Œå†ä¸­ç­‰ï¼Œæœ€åå›°éš¾
curriculum_schedule = [
    (1, easy_loader),    # ç¬¬ 1-2 epoch ç”¨ç®€å•æ•°æ®
    (3, medium_loader),  # ç¬¬ 3-4 epoch ç”¨ä¸­ç­‰æ•°æ®
    (5, hard_loader),    # ç¬¬ 5-6 epoch ç”¨å›°éš¾æ•°æ®
]

for start_epoch, loader in curriculum_schedule:
    for epoch in range(start_epoch, start_epoch + 2):
        train_epoch(loader, model, optimizer, criterion, epoch)

# 8. æµ‹è¯•æ¨¡å‹
test_loader = DataLoader(datasets.MNIST('.', train=False, transform=transform), batch_size=64)
model.eval()
correct = 0
total = 0
with torch.no_grad():
    for data, target in test_loader:
        data, target = data.to(device), target.to(device)
        output = model(data)
        pred = output.argmax(dim=1, keepdim=True)
        correct += pred.eq(target.view_as(pred)).sum().item()
        total += target.size(0)
print(f"Test Accuracy: {correct / total * 100:.2f}%")
```



### ğŸ“– ä»£ç è¯´æ˜

1. **éš¾åº¦å®šä¹‰**ï¼š
   - ä½¿ç”¨åƒç´ å‡å€¼ä½œä¸ºéš¾åº¦æŒ‡æ ‡ï¼ˆç®€å•çš„å‡è®¾ï¼šè¾ƒæš—çš„å›¾åƒæ›´éš¾è¯†åˆ«ï¼‰ã€‚
   - `compute_difficulty` å‡½æ•°è®¡ç®—æ¯ä¸ªå›¾åƒçš„åƒç´ å‡å€¼ï¼Œä½œä¸ºéš¾åº¦åˆ†æ•°ã€‚

2. **æ•°æ®åˆ†ç»„**ï¼š
   - æ ¹æ®éš¾åº¦åˆ†æ•°å¯¹æ•°æ®é›†æ’åºï¼Œå¹¶åˆ†æˆä¸‰ç»„ï¼šç®€å•ï¼ˆå‰ 1/3ï¼‰ã€ä¸­ç­‰ï¼ˆä¸­é—´ 1/3ï¼‰ã€å›°éš¾ï¼ˆå 1/3ï¼‰ã€‚

3. **è¯¾ç¨‹è°ƒåº¦**ï¼š
   - è®­ç»ƒåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š
     - ç¬¬ 1-2 epochï¼šåªç”¨ç®€å•æ•°æ®ã€‚
     - ç¬¬ 3-4 epochï¼šç”¨ä¸­ç­‰éš¾åº¦æ•°æ®ã€‚
     - ç¬¬ 5-6 epochï¼šç”¨å›°éš¾æ•°æ®ã€‚
   - æ¯ä¸ªé˜¶æ®µä½¿ç”¨å¯¹åº”çš„ `DataLoader`ã€‚

4. **è®­ç»ƒä¸æµ‹è¯•**ï¼š
   - è®­ç»ƒå¾ªç¯ä¸æ™®é€šè®­ç»ƒç±»ä¼¼ï¼Œä½†æ•°æ®æŒ‰éš¾åº¦é€æ­¥å¼•å…¥ã€‚
   - æœ€ååœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°æ¨¡å‹æ€§èƒ½ã€‚



### ğŸ“– å…³é”®ç‚¹
1. **éš¾åº¦æ ‡å‡†**ï¼šæœ¬ä¾‹ä¸­ç”¨åƒç´ å‡å€¼ä½œä¸ºéš¾åº¦ï¼Œå®é™…åº”ç”¨ä¸­å¯ä»¥æ ¹æ®ä»»åŠ¡è‡ªå®šä¹‰ï¼ˆä¾‹å¦‚å¥å­é•¿åº¦ã€å™ªå£°æ°´å¹³ã€æŸå¤±å€¼ç­‰ï¼‰ã€‚
2. **è°ƒåº¦ç­–ç•¥**ï¼šæœ¬ä¾‹ç”¨å›ºå®šé˜¶æ®µåˆ‡æ¢ï¼Œå®é™…ä¸­å¯ä»¥åŠ¨æ€è°ƒæ•´ï¼ˆå¦‚æ ¹æ®æ¨¡å‹æ”¶æ•›æƒ…å†µï¼‰ã€‚
3. **æ‰©å±•æ€§**ï¼šå¯ä»¥ç»“åˆ AMPï¼ˆè‡ªåŠ¨æ··åˆç²¾åº¦ï¼‰è¿›ä¸€æ­¥åŠ é€Ÿè®­ç»ƒï¼Œæ–¹æ³•æ˜¯å°† `torch.cuda.amp.autocast()` å’Œ `GradScaler` åŠ å…¥è®­ç»ƒå¾ªç¯ï¼ˆå‚è€ƒå‰æ–‡ AMP ç¤ºä¾‹ï¼‰ã€‚



### ğŸ“– å®é™…æ•ˆæœ
- **æ”¶æ•›é€Ÿåº¦**ï¼šCurriculum Learning é€šå¸¸èƒ½åŠ é€Ÿæ¨¡å‹æ”¶æ•›ï¼Œå°¤å…¶åœ¨å¤æ‚æ•°æ®é›†ä¸Šã€‚
- **æ³›åŒ–èƒ½åŠ›**ï¼šé€šè¿‡ä»æ˜“åˆ°éš¾å­¦ä¹ ï¼Œæ¨¡å‹åœ¨å›°éš¾æ ·æœ¬ä¸Šçš„è¡¨ç°æ›´ç¨³å®šã€‚
- **çµæ´»æ€§**ï¼šå¯ä»¥æ ¹æ®ä»»åŠ¡è°ƒæ•´éš¾åº¦å®šä¹‰å’Œè°ƒåº¦ç­–ç•¥ã€‚
